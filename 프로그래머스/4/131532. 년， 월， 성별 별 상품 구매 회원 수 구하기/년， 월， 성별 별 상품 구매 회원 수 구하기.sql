SELECT
    YEAR(SALES_DATE) AS YEAR,
    MONTH(SALES_DATE) AS MONTH,
    GENDER AS GENDER,
    COUNT(DISTINCT a.USER_ID) AS USERS

FROM
    ONLINE_SALE AS a
JOIN
    (
        SELECT *
        FROM USER_INFO
        WHERE GENDER IS NOT NULL
    ) AS b
ON
    a.USER_ID = b.USER_ID

GROUP BY
    YEAR,
    MONTH,
    GENDER

ORDER BY
    YEAR,
    MONTH,
    GENDER

